{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/file-upload/dropzone/index.tsx"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport React, { useEffect, useState } from 'react';\nimport styles from './styles.css.js';\nimport clsx from 'clsx';\nimport InternalIcon from '../../icon/internal';\n\ninterface DropzoneProps {\n  onChange: (files: File[]) => void;\n  children: React.ReactNode;\n}\n\nexport function useDropzoneVisible(multiple: boolean) {\n  const [isDropzoneVisible, setDropzoneVisible] = useState(false);\n\n  // Registering global drag events listeners.\n  useEffect(() => {\n    // The timer helps avoiding dropzone blinking.\n    let dragTimer: null | ReturnType<typeof setTimeout> = null;\n\n    // The file-upload dropzone is shown when the user drags files over to the browser.\n    const onDocumentDragOver = (event: DragEvent) => {\n      event.preventDefault();\n\n      let files = 0;\n      for (let item = 0; item < (event.dataTransfer?.items.length || 0); item++) {\n        if (event.dataTransfer?.items[item].kind === 'file') {\n          files++;\n        }\n      }\n      if (files > 0 && (multiple || files === 1)) {\n        setDropzoneVisible(true);\n        dragTimer && clearTimeout(dragTimer);\n      }\n    };\n\n    // When the files are no longer dragged over the browser the state must be reset.\n    const onDocumentDragLeave = (event: DragEvent) => {\n      event.preventDefault();\n\n      dragTimer = setTimeout(() => setDropzoneVisible(false), 25);\n    };\n\n    // If the files were dropped the state must be reset.\n    const onDocumentDrop = (event: DragEvent) => {\n      event.preventDefault();\n\n      dragTimer = setTimeout(() => setDropzoneVisible(false), 25);\n    };\n\n    document.addEventListener('dragover', onDocumentDragOver, false);\n    document.addEventListener('dragleave', onDocumentDragLeave, false);\n    document.addEventListener('drop', onDocumentDrop, false);\n\n    return () => {\n      dragTimer && clearTimeout(dragTimer);\n      document.removeEventListener('dragover', onDocumentDragOver);\n      document.removeEventListener('dragleave', onDocumentDragLeave);\n      document.removeEventListener('drop', onDocumentDrop);\n    };\n  }, [multiple]);\n\n  return isDropzoneVisible;\n}\n\nexport function Dropzone({ onChange, children }: DropzoneProps) {\n  const [isDropzoneHovered, setDropzoneHovered] = useState(false);\n\n  const onDragOver = (event: React.DragEvent) => {\n    event.preventDefault();\n\n    if (event.dataTransfer) {\n      setDropzoneHovered(true);\n      event.dataTransfer.dropEffect = 'copy';\n    }\n  };\n\n  const onDragLeave = (event: React.DragEvent) => {\n    event.preventDefault();\n    setDropzoneHovered(false);\n\n    if (event.dataTransfer) {\n      event.dataTransfer.dropEffect = 'none';\n    }\n  };\n\n  const onDrop = (event: React.DragEvent) => {\n    event.preventDefault();\n    setDropzoneHovered(false);\n\n    onChange(Array.from(event.dataTransfer.files));\n  };\n\n  return (\n    <div\n      className={clsx(styles.dropzone, isDropzoneHovered && styles['dropzone-hovered'])}\n      onDragOver={onDragOver}\n      onDragLeave={onDragLeave}\n      onDrop={onDrop}\n    >\n      <InternalIcon name=\"upload\" />\n      <span>{children}</span>\n    </div>\n  );\n}\n"]}