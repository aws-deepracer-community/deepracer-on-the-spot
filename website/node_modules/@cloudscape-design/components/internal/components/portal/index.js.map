{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../../src/internal/components/portal/index.tsx"],"names":[],"mappings":"AAAA,qEAAqE;AACrE,sCAAsC;AACtC,OAAc,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AACzD,OAAO,EAAE,YAAY,EAAE,MAAM,WAAW,CAAC;AACzC,OAAO,EAAE,QAAQ,EAAE,MAAM,+CAA+C,CAAC;AACzE,OAAO,EAAE,aAAa,EAAE,MAAM,sBAAsB,CAAC;AASrD,SAAS,sBAAsB,CAAC,QAA8D;IAC5F,MAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IACnD,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;IACxC,QAAQ,CAAC,YAAY,CAAC,CAAC;IACvB,OAAO,GAAG,EAAE;QACV,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;IAC1C,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,oBAAoB,CAC3B,YAAwC,EACxC,eAAiD,EACjD,QAA8D;IAE9D,IAAI,YAAyB,CAAC;IAC9B,YAAY,EAAE,CAAC,IAAI,CACjB,SAAS,CAAC,EAAE;QACV,YAAY,GAAG,SAAS,CAAC;QACzB,QAAQ,CAAC,SAAS,CAAC,CAAC;IACtB,CAAC,EACD,KAAK,CAAC,EAAE;QACN,OAAO,CAAC,IAAI,CAAC,8CAA8C,EAAE,KAAK,CAAC,CAAC;IACtE,CAAC,CACF,CAAC;IACF,OAAO,GAAG,EAAE;QACV,eAAe,CAAC,YAAY,CAAC,CAAC;IAChC,CAAC,CAAC;AACJ,CAAC;AAED;;;GAGG;AACH,MAAM,CAAC,OAAO,UAAU,MAAM,CAAC,EAAE,SAAS,EAAE,YAAY,EAAE,eAAe,EAAE,QAAQ,EAAe;IAChG,MAAM,CAAC,eAAe,EAAE,kBAAkB,CAAC,GAAG,QAAQ,CAAiB,SAAS,aAAT,SAAS,cAAT,SAAS,GAAI,IAAI,CAAC,CAAC;IAE1F,eAAe,CAAC,GAAG,EAAE;QACnB,IAAI,SAAS,EAAE;YACb,kBAAkB,CAAC,SAAS,CAAC,CAAC;YAC9B,OAAO;SACR;QACD,IAAI,aAAa,EAAE;YACjB,IAAI,YAAY,IAAI,CAAC,eAAe,EAAE;gBACpC,QAAQ,CAAC,QAAQ,EAAE,+DAA+D,CAAC,CAAC;aACrF;YACD,IAAI,CAAC,YAAY,IAAI,eAAe,EAAE;gBACpC,QAAQ,CAAC,QAAQ,EAAE,+DAA+D,CAAC,CAAC;aACrF;SACF;QAED,IAAI,YAAY,IAAI,eAAe,EAAE;YACnC,OAAO,oBAAoB,CAAC,YAAY,EAAE,eAAe,EAAE,kBAAkB,CAAC,CAAC;SAChF;QACD,OAAO,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;IACpD,CAAC,EAAE,CAAC,SAAS,EAAE,YAAY,EAAE,eAAe,CAAC,CAAC,CAAC;IAE/C,OAAO,eAAe,IAAI,YAAY,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;AACpE,CAAC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React, { useLayoutEffect, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { warnOnce } from '@cloudscape-design/component-toolkit/internal';\nimport { isDevelopment } from '../../is-development';\n\nexport interface PortalProps {\n  container?: null | Element;\n  getContainer?: () => Promise<HTMLElement>;\n  removeContainer?: (container: HTMLElement) => void;\n  children: React.ReactNode;\n}\n\nfunction manageDefaultContainer(setState: React.Dispatch<React.SetStateAction<Element | null>>) {\n  const newContainer = document.createElement('div');\n  document.body.appendChild(newContainer);\n  setState(newContainer);\n  return () => {\n    document.body.removeChild(newContainer);\n  };\n}\n\nfunction manageAsyncContainer(\n  getContainer: () => Promise<HTMLElement>,\n  removeContainer: (container: HTMLElement) => void,\n  setState: React.Dispatch<React.SetStateAction<Element | null>>\n) {\n  let newContainer: HTMLElement;\n  getContainer().then(\n    container => {\n      newContainer = container;\n      setState(container);\n    },\n    error => {\n      console.warn('[AwsUi] [portal]: failed to load portal root', error);\n    }\n  );\n  return () => {\n    removeContainer(newContainer);\n  };\n}\n\n/**\n * A safe react portal component that renders to a provided node.\n * If a node isn't provided, it creates one under document.body.\n */\nexport default function Portal({ container, getContainer, removeContainer, children }: PortalProps) {\n  const [activeContainer, setActiveContainer] = useState<Element | null>(container ?? null);\n\n  useLayoutEffect(() => {\n    if (container) {\n      setActiveContainer(container);\n      return;\n    }\n    if (isDevelopment) {\n      if (getContainer && !removeContainer) {\n        warnOnce('portal', '`removeContainer` is required when `getContainer` is provided');\n      }\n      if (!getContainer && removeContainer) {\n        warnOnce('portal', '`getContainer` is required when `removeContainer` is provided');\n      }\n    }\n\n    if (getContainer && removeContainer) {\n      return manageAsyncContainer(getContainer, removeContainer, setActiveContainer);\n    }\n    return manageDefaultContainer(setActiveContainer);\n  }, [container, getContainer, removeContainer]);\n\n  return activeContainer && createPortal(children, activeContainer);\n}\n"]}