// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
import React, { useRef } from 'react';
import styles from '../styles.css.js';
import clsx from 'clsx';
import { useEffectOnUpdate } from '../../internal/hooks/use-effect-on-update.js';
import ScreenreaderOnly from '../../internal/components/screenreader-only/index.js';
export default function Grid({ isDateEnabled, focusedDate, focusableDate, onSelectDate, selectedDate, ariaLabelledby, header, rows, isCurrentPage, renderDate, renderDateAnnouncement, isSameDate, onGridKeyDownHandler, }) {
    const focusedDateRef = useRef(null);
    // The focused date changes as a feedback to keyboard navigation in the grid.
    // Once changed, the corresponding date button needs to receive the actual focus.
    useEffectOnUpdate(() => {
        if (focusedDate && focusedDateRef.current) {
            focusedDateRef.current.focus();
        }
    }, [focusedDate]);
    const rowLength = rows[0].length;
    const denseGrid = rowLength > 3;
    return (React.createElement("table", { role: "grid", className: clsx(styles['calendar-grid'], denseGrid && styles['calendar-grid-dense']), "aria-labelledby": ariaLabelledby },
        header,
        React.createElement("tbody", { onKeyDown: onGridKeyDownHandler }, rows.map((row, rowIndex) => (React.createElement("tr", { key: rowIndex, className: styles['calendar-row'] }, row.map((date, dateIndex) => {
            const isFocusable = !!focusableDate && isSameDate(date, focusableDate);
            const isSelected = !!selectedDate && isSameDate(date, selectedDate);
            const isEnabled = !isDateEnabled || isDateEnabled(date);
            const isCurrentDate = isSameDate(date, new Date());
            // Can't be focused.
            let tabIndex = undefined;
            if (isFocusable && isEnabled) {
                // Next focus target.
                tabIndex = 0;
            }
            else if (isEnabled) {
                // Can be focused programmatically.
                tabIndex = -1;
            }
            return (React.createElement("td", { key: `${rowIndex}:${dateIndex}`, ref: tabIndex === 0 ? focusedDateRef : undefined, tabIndex: tabIndex, "aria-current": isCurrentDate ? 'date' : undefined, "aria-selected": isEnabled ? isSelected : undefined, "aria-disabled": !isEnabled, 
                // Do not attach click event when the date is disabled, otherwise VO+safari announces clickable
                onClick: isEnabled ? () => onSelectDate(date) : undefined, className: clsx(styles['calendar-grid-cell'], styles['calendar-date'], {
                    [styles['calendar-date-current-page']]: isCurrentPage(date),
                    [styles['calendar-date-enabled']]: isEnabled,
                    [styles['calendar-date-selected']]: isSelected,
                    [styles['calendar-date-current']]: isCurrentDate,
                    [styles['calendar-date-dense']]: denseGrid,
                }) },
                React.createElement("span", { className: styles['date-inner'], "aria-hidden": "true" }, renderDate(date)),
                React.createElement(ScreenreaderOnly, null, renderDateAnnouncement(date, isCurrentDate))));
        })))))));
}
//# sourceMappingURL=index.js.map